Thu Feb 17 13:40:09 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 495.46       Driver Version: 495.46       CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-PCI...  On   | 00000000:37:00.0 Off |                    0 |
| N/A   41C    P0    34W / 250W |      0MiB / 40536MiB |      0%   E. Process |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-PCI...  On   | 00000000:86:00.0 Off |                    0 |
| N/A   32C    P0    32W / 250W |      0MiB / 40536MiB |      0%   E. Process |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
=> danet start
2022-02-17 13:40:46,039 Segmentron INFO: Using 2 GPUs
2022-02-17 13:40:46,039 Segmentron INFO: Namespace(config_file='configs/cityscapes_danet_resnet.yaml', device='cuda', distributed=True, input_img='tools/demo_vis.png', local_rank=0, log_iter=10, no_cuda=False, num_gpus=2, opts=[], resume=None, skip_val=False, val_epoch=1)
2022-02-17 13:40:46,040 Segmentron INFO: {
        "SEED": 1024,
        "TIME_STAMP": "2022-02-17-13-40",
        "ROOT_PATH": "/zhome/f9/4/160189/SegmenTron",
        "PHASE": "train",
        "DATASET": {
                "NAME": "cityscape",
                "MEAN": [
                        0.485,
                        0.456,
                        0.406
                ],
                "STD": [
                        0.229,
                        0.224,
                        0.225
                ],
                "IGNORE_INDEX": -1,
                "WORKERS": 4,
                "MODE": "testval"
        },
        "AUG": {
                "MIRROR": true,
                "BLUR_PROB": 0.0,
                "BLUR_RADIUS": 0.0,
                "COLOR_JITTER": null
        },
        "TRAIN": {
                "EPOCHS": 240,
                "BATCH_SIZE": 6,
                "CROP_SIZE": 768,
                "BASE_SIZE": 1024,
                "MODEL_SAVE_DIR": "runs/checkpoints/",
                "LOG_SAVE_DIR": "runs/logs/",
                "PRETRAINED_MODEL_PATH": "",
                "BACKBONE_PRETRAINED": true,
                "BACKBONE_PRETRAINED_PATH": "",
                "RESUME_MODEL_PATH": "",
                "SYNC_BATCH_NORM": true,
                "SNAPSHOT_EPOCH": 10
        },
        "SOLVER": {
                "LR": 0.003,
                "OPTIMIZER": "sgd",
                "EPSILON": 1e-08,
                "MOMENTUM": 0.9,
                "WEIGHT_DECAY": 0.0001,
                "DECODER_LR_FACTOR": 10.0,
                "LR_SCHEDULER": "poly",
                "POLY": {
                        "POWER": 0.9
                },
                "STEP": {
                        "GAMMA": 0.1,
                        "DECAY_EPOCH": [
                                10,
                                20
                        ]
                },
                "WARMUP": {
                        "EPOCHS": 0.0,
                        "FACTOR": 0.3333333333333333,
                        "METHOD": "linear"
                },
                "OHEM": false,
                "AUX": false,
                "AUX_WEIGHT": 0.4,
                "LOSS_NAME": ""
        },
        "TEST": {
                "TEST_MODEL_PATH": "",
                "BATCH_SIZE": 4,
                "CROP_SIZE": null,
                "SCALES": [
                        1.0
                ],
                "FLIP": false
        },
        "VISUAL": {
                "OUTPUT_DIR": "../runs/visual/"
        },
        "MODEL": {
                "MODEL_NAME": "DANet",
                "BACKBONE": "resnet50",
                "BACKBONE_SCALE": 1.0,
                "MULTI_LOSS_WEIGHT": [
                        1.0
                ],
                "DEFAULT_GROUP_NUMBER": 32,
                "DEFAULT_EPSILON": 1e-05,
                "BN_TYPE": "BN",
                "BN_EPS_FOR_ENCODER": null,
                "BN_EPS_FOR_DECODER": null,
                "OUTPUT_STRIDE": 8,
                "BN_MOMENTUM": null,
                "DANET": {
                        "MULTI_DILATION": [
                                4,
                                8,
                                16
                        ],
                        "MULTI_GRID": true
                },
                "CCNET": {
                        "RECURRENCE": 2
                }
        }
}
2022-02-17 13:40:46,785 Segmentron INFO: Found 2975 images in the folder /zhome/f9/4/160189/SegmenTron/datasets/cityscapes/leftImg8bit/train
2022-02-17 13:40:46,906 Segmentron INFO: Found 500 images in the folder /zhome/f9/4/160189/SegmenTron/datasets/cityscapes/leftImg8bit/val
2022-02-17 13:40:47,297 Segmentron INFO: load backbone pretrained model from url..
2022-02-17 13:40:48,756 Segmentron INFO: <All keys matched successfully>
2022-02-17 13:40:54,504 Segmentron INFO: DANet flops: 1584.404G input shape is [3, 1024, 2048], params: 47.463M
2022-02-17 13:40:54,520 Segmentron INFO: SyncBatchNorm is effective!
2022-02-17 13:40:54,545 Segmentron INFO: Start training, Total Epochs: 240 = Total Iterations 59280
2022-02-17 13:41:14,854 Segmentron INFO: Epoch: 1/240 || Iters: 10/247 || Lr: 0.003000 || Loss: 2.8487 || Cost Time: 0:00:20 || Estimated Time: 1 day, 9:26:08
2022-02-17 13:41:24,582 Segmentron INFO: Epoch: 1/240 || Iters: 20/247 || Lr: 0.002999 || Loss: 3.3704 || Cost Time: 0:00:30 || Estimated Time: 1 day, 0:43:19
2022-02-17 13:41:34,321 Segmentron INFO: Epoch: 1/240 || Iters: 30/247 || Lr: 0.002999 || Loss: 3.8486 || Cost Time: 0:00:39 || Estimated Time: 21:49:17
2022-02-17 13:41:44,065 Segmentron INFO: Epoch: 1/240 || Iters: 40/247 || Lr: 0.002998 || Loss: 2.3748 || Cost Time: 0:00:49 || Estimated Time: 20:22:19
2022-02-17 13:41:53,839 Segmentron INFO: Epoch: 1/240 || Iters: 50/247 || Lr: 0.002998 || Loss: 1.7330 || Cost Time: 0:00:59 || Estimated Time: 19:30:40
2022-02-17 13:42:03,603 Segmentron INFO: Epoch: 1/240 || Iters: 60/247 || Lr: 0.002997 || Loss: 2.6076 || Cost Time: 0:01:09 || Estimated Time: 18:56:00
2022-02-17 13:42:13,392 Segmentron INFO: Epoch: 1/240 || Iters: 70/247 || Lr: 0.002997 || Loss: 1.5884 || Cost Time: 0:01:18 || Estimated Time: 18:31:33
2022-02-17 13:42:23,197 Segmentron INFO: Epoch: 1/240 || Iters: 80/247 || Lr: 0.002996 || Loss: 1.3847 || Cost Time: 0:01:28 || Estimated Time: 18:13:22
2022-02-17 13:42:33,003 Segmentron INFO: Epoch: 1/240 || Iters: 90/247 || Lr: 0.002996 || Loss: 1.6092 || Cost Time: 0:01:38 || Estimated Time: 17:59:12
2022-02-17 13:42:42,806 Segmentron INFO: Epoch: 1/240 || Iters: 100/247 || Lr: 0.002995 || Loss: 2.0825 || Cost Time: 0:01:48 || Estimated Time: 17:47:48
2022-02-17 13:42:52,621 Segmentron INFO: Epoch: 1/240 || Iters: 110/247 || Lr: 0.002995 || Loss: 2.1756 || Cost Time: 0:01:58 || Estimated Time: 17:38:34
2022-02-17 13:43:02,434 Segmentron INFO: Epoch: 1/240 || Iters: 120/247 || Lr: 0.002995 || Loss: 1.9601 || Cost Time: 0:02:07 || Estimated Time: 17:30:49
2022-02-17 13:43:12,264 Segmentron INFO: Epoch: 1/240 || Iters: 130/247 || Lr: 0.002994 || Loss: 1.2501 || Cost Time: 0:02:17 || Estimated Time: 17:24:22
2022-02-17 13:43:22,094 Segmentron INFO: Epoch: 1/240 || Iters: 140/247 || Lr: 0.002994 || Loss: 1.5191 || Cost Time: 0:02:27 || Estimated Time: 17:18:48
2022-02-17 13:43:31,930 Segmentron INFO: Epoch: 1/240 || Iters: 150/247 || Lr: 0.002993 || Loss: 1.7703 || Cost Time: 0:02:37 || Estimated Time: 17:14:01
2022-02-17 13:43:41,782 Segmentron INFO: Epoch: 1/240 || Iters: 160/247 || Lr: 0.002993 || Loss: 2.4173 || Cost Time: 0:02:47 || Estimated Time: 17:09:54
2022-02-17 13:43:51,638 Segmentron INFO: Epoch: 1/240 || Iters: 170/247 || Lr: 0.002992 || Loss: 1.6235 || Cost Time: 0:02:57 || Estimated Time: 17:06:16
2022-02-17 13:44:01,492 Segmentron INFO: Epoch: 1/240 || Iters: 180/247 || Lr: 0.002992 || Loss: 1.0037 || Cost Time: 0:03:06 || Estimated Time: 17:03:00
2022-02-17 13:44:11,379 Segmentron INFO: Epoch: 1/240 || Iters: 190/247 || Lr: 0.002991 || Loss: 1.1312 || Cost Time: 0:03:16 || Estimated Time: 17:00:15
2022-02-17 13:44:21,236 Segmentron INFO: Epoch: 1/240 || Iters: 200/247 || Lr: 0.002991 || Loss: 1.0181 || Cost Time: 0:03:26 || Estimated Time: 16:57:36
2022-02-17 13:44:31,102 Segmentron INFO: Epoch: 1/240 || Iters: 210/247 || Lr: 0.002990 || Loss: 1.3151 || Cost Time: 0:03:36 || Estimated Time: 16:55:14
2022-02-17 13:44:40,985 Segmentron INFO: Epoch: 1/240 || Iters: 220/247 || Lr: 0.002990 || Loss: 1.0273 || Cost Time: 0:03:46 || Estimated Time: 16:53:08
2022-02-17 13:44:50,860 Segmentron INFO: Epoch: 1/240 || Iters: 230/247 || Lr: 0.002990 || Loss: 1.2680 || Cost Time: 0:03:56 || Estimated Time: 16:51:11
2022-02-17 13:45:00,709 Segmentron INFO: Epoch: 1/240 || Iters: 240/247 || Lr: 0.002989 || Loss: 1.2169 || Cost Time: 0:04:06 || Estimated Time: 16:49:16
2022-02-17 13:45:11,499 Segmentron INFO: Epoch 1 model saved in: runs/checkpoints/DANet_resnet50_cityscape_2022-02-17-13-40/1.pth
Killing subprocess 5091
Killing subprocess 5092
