Loaded module: python3/3.6.2
INFO:Segmentron:Using 2 GPUs
INFO:Segmentron:Namespace(config_file='configs/cityscapes_danet_resnet.yaml', device='cuda', distributed=True, input_img='tools/demo_vis.png', local_rank=0, log_iter=10, no_cuda=False, num_gpus=2, opts=[], resume=None, skip_val=False, val_epoch=1)
INFO:Segmentron:{
        "SEED": 1024,
        "TIME_STAMP": "2022-02-17-13-54",
        "ROOT_PATH": "/zhome/f9/4/160189/SegmenTron",
        "PHASE": "train",
        "DATASET": {
                "NAME": "cityscape",
                "MEAN": [
                        0.485,
                        0.456,
                        0.406
                ],
                "STD": [
                        0.229,
                        0.224,
                        0.225
                ],
                "IGNORE_INDEX": -1,
                "WORKERS": 4,
                "MODE": "testval"
        },
        "AUG": {
                "MIRROR": true,
                "BLUR_PROB": 0.0,
                "BLUR_RADIUS": 0.0,
                "COLOR_JITTER": null
        },
        "TRAIN": {
                "EPOCHS": 240,
                "BATCH_SIZE": 6,
                "CROP_SIZE": 768,
                "BASE_SIZE": 1024,
                "MODEL_SAVE_DIR": "/work3/s210203/runs/checkpoints/",
                "LOG_SAVE_DIR": "/work3/s210203/runs/logs/",
                "PRETRAINED_MODEL_PATH": "",
                "BACKBONE_PRETRAINED": true,
                "BACKBONE_PRETRAINED_PATH": "",
                "RESUME_MODEL_PATH": "",
                "SYNC_BATCH_NORM": true,
                "SNAPSHOT_EPOCH": 10
        },
        "SOLVER": {
                "LR": 0.003,
                "OPTIMIZER": "sgd",
                "EPSILON": 1e-08,
                "MOMENTUM": 0.9,
                "WEIGHT_DECAY": 0.0001,
                "DECODER_LR_FACTOR": 10.0,
                "LR_SCHEDULER": "poly",
                "POLY": {
                        "POWER": 0.9
                },
                "STEP": {
                        "GAMMA": 0.1,
                        "DECAY_EPOCH": [
                                10,
                                20
                        ]
                },
                "WARMUP": {
                        "EPOCHS": 0.0,
                        "FACTOR": 0.3333333333333333,
                        "METHOD": "linear"
                },
                "OHEM": false,
                "AUX": false,
                "AUX_WEIGHT": 0.4,
                "LOSS_NAME": ""
        },
        "TEST": {
                "TEST_MODEL_PATH": "",
                "BATCH_SIZE": 4,
                "CROP_SIZE": null,
                "SCALES": [
                        1.0
                ],
                "FLIP": false
        },
        "VISUAL": {
                "OUTPUT_DIR": "/work3/s210203/runs/visual/"
        },
        "MODEL": {
                "MODEL_NAME": "DANet",
                "BACKBONE": "resnet50",
                "BACKBONE_SCALE": 1.0,
                "MULTI_LOSS_WEIGHT": [
                        1.0
                ],
                "DEFAULT_GROUP_NUMBER": 32,
                "DEFAULT_EPSILON": 1e-05,
                "BN_TYPE": "BN",
                "BN_EPS_FOR_ENCODER": null,
                "BN_EPS_FOR_DECODER": null,
                "OUTPUT_STRIDE": 8,
                "BN_MOMENTUM": null,
                "DANET": {
                        "MULTI_DILATION": [
                                4,
                                8,
                                16
                        ],
                        "MULTI_GRID": true
                },
                "CCNET": {
                        "RECURRENCE": 2
                }
        }
}
INFO:Segmentron:Found 2975 images in the folder /zhome/f9/4/160189/SegmenTron/datasets/cityscapes/leftImg8bit/train
INFO:Segmentron:Found 500 images in the folder /zhome/f9/4/160189/SegmenTron/datasets/cityscapes/leftImg8bit/val
INFO:Segmentron:load backbone pretrained model from url..
INFO:Segmentron:<All keys matched successfully>
INFO:Segmentron:DANet flops: 1584.404G input shape is [3, 1024, 2048], params: 47.463M
INFO:Segmentron:SyncBatchNorm is effective!
INFO:Segmentron:Start training, Total Epochs: 240 = Total Iterations 59280
INFO:Segmentron:Epoch: 1/240 || Iters: 10/247 || Lr: 0.003000 || Loss: 2.7946 || Cost Time: 0:00:20 || Estimated Time: 1 day, 9:15:04
INFO:Segmentron:Epoch: 1/240 || Iters: 20/247 || Lr: 0.002999 || Loss: 2.9584 || Cost Time: 0:00:29 || Estimated Time: 1 day, 0:35:06
INFO:Segmentron:Epoch: 1/240 || Iters: 30/247 || Lr: 0.002999 || Loss: 3.9183 || Cost Time: 0:00:39 || Estimated Time: 21:42:19
INFO:Segmentron:Epoch: 1/240 || Iters: 40/247 || Lr: 0.002998 || Loss: 2.6682 || Cost Time: 0:00:49 || Estimated Time: 20:16:43
INFO:Segmentron:Epoch: 1/240 || Iters: 50/247 || Lr: 0.002998 || Loss: 1.9454 || Cost Time: 0:00:59 || Estimated Time: 19:26:06
INFO:Segmentron:Epoch: 1/240 || Iters: 60/247 || Lr: 0.002997 || Loss: 3.8758 || Cost Time: 0:01:08 || Estimated Time: 18:52:16
INFO:Segmentron:Epoch: 1/240 || Iters: 70/247 || Lr: 0.002997 || Loss: 1.7881 || Cost Time: 0:01:18 || Estimated Time: 18:28:12
INFO:Segmentron:Epoch: 1/240 || Iters: 80/247 || Lr: 0.002996 || Loss: 1.5548 || Cost Time: 0:01:28 || Estimated Time: 18:10:19
INFO:Segmentron:Epoch: 1/240 || Iters: 90/247 || Lr: 0.002996 || Loss: 2.0379 || Cost Time: 0:01:38 || Estimated Time: 17:56:36
INFO:Segmentron:Epoch: 1/240 || Iters: 100/247 || Lr: 0.002995 || Loss: 2.1991 || Cost Time: 0:01:48 || Estimated Time: 17:45:18
INFO:Segmentron:Epoch: 1/240 || Iters: 110/247 || Lr: 0.002995 || Loss: 2.4931 || Cost Time: 0:01:57 || Estimated Time: 17:36:11
INFO:Segmentron:Epoch: 1/240 || Iters: 120/247 || Lr: 0.002995 || Loss: 2.1508 || Cost Time: 0:02:07 || Estimated Time: 17:28:33
INFO:Segmentron:Epoch: 1/240 || Iters: 130/247 || Lr: 0.002994 || Loss: 1.3184 || Cost Time: 0:02:17 || Estimated Time: 17:22:16
INFO:Segmentron:Epoch: 1/240 || Iters: 140/247 || Lr: 0.002994 || Loss: 1.7822 || Cost Time: 0:02:27 || Estimated Time: 17:17:01
INFO:Segmentron:Epoch: 1/240 || Iters: 150/247 || Lr: 0.002993 || Loss: 1.9331 || Cost Time: 0:02:37 || Estimated Time: 17:12:24
INFO:Segmentron:Epoch: 1/240 || Iters: 160/247 || Lr: 0.002993 || Loss: 2.5808 || Cost Time: 0:02:46 || Estimated Time: 17:08:12
INFO:Segmentron:Epoch: 1/240 || Iters: 170/247 || Lr: 0.002992 || Loss: 1.7234 || Cost Time: 0:02:56 || Estimated Time: 17:04:35
INFO:Segmentron:Epoch: 1/240 || Iters: 180/247 || Lr: 0.002992 || Loss: 1.0713 || Cost Time: 0:03:06 || Estimated Time: 17:01:33
INFO:Segmentron:Epoch: 1/240 || Iters: 190/247 || Lr: 0.002991 || Loss: 1.2822 || Cost Time: 0:03:16 || Estimated Time: 16:58:48
INFO:Segmentron:Epoch: 1/240 || Iters: 200/247 || Lr: 0.002991 || Loss: 1.0436 || Cost Time: 0:03:26 || Estimated Time: 16:56:14
INFO:Segmentron:Epoch: 1/240 || Iters: 210/247 || Lr: 0.002990 || Loss: 1.3627 || Cost Time: 0:03:36 || Estimated Time: 16:53:54
INFO:Segmentron:Epoch: 1/240 || Iters: 220/247 || Lr: 0.002990 || Loss: 1.1022 || Cost Time: 0:03:46 || Estimated Time: 16:51:52
INFO:Segmentron:Epoch: 1/240 || Iters: 230/247 || Lr: 0.002990 || Loss: 1.5182 || Cost Time: 0:03:56 || Estimated Time: 16:50:00
INFO:Segmentron:Epoch: 1/240 || Iters: 240/247 || Lr: 0.002989 || Loss: 1.3353 || Cost Time: 0:04:05 || Estimated Time: 16:48:16
INFO:Segmentron:Epoch 1 model saved in: /work3/s210203/runs/checkpoints/DANet_resnet50_cityscape_2022-02-17-13-54/1.pth
Traceback (most recent call last):
  File "./tools/train.py", line 258, in <module>
    trainer.train()
  File "./tools/train.py", line 180, in train
    self.validation(epoch)
  File "./tools/train.py", line 206, in validation
    output = model(image)[0]
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/SegmenTron/segmentron/models/danet.py", line 30, in forward
    x = self.head(c4)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/SegmenTron/segmentron/models/danet.py", line 72, in forward
    sa_feat = self.sa(feat1)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/SegmenTron/segmentron/modules/module.py", line 124, in forward
    attention = self.softmax(energy)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/activation.py", line 1200, in forward
    return F.softmax(input, self.dim, _stacklevel=5)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/functional.py", line 1583, in softmax
    ret = input.softmax(dim)
RuntimeError: CUDA out of memory. Tried to allocate 16.00 GiB (GPU 1; 39.59 GiB total capacity; 19.77 GiB already allocated; 1.64 GiB free; 36.05 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "./tools/train.py", line 258, in <module>
    trainer.train()
  File "./tools/train.py", line 180, in train
    self.validation(epoch)
  File "./tools/train.py", line 206, in validation
    output = model(image)[0]
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/SegmenTron/segmentron/models/danet.py", line 30, in forward
    x = self.head(c4)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/SegmenTron/segmentron/models/danet.py", line 72, in forward
    sa_feat = self.sa(feat1)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/SegmenTron/segmentron/modules/module.py", line 124, in forward
    attention = self.softmax(energy)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/modules/activation.py", line 1200, in forward
    return F.softmax(input, self.dim, _stacklevel=5)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/nn/functional.py", line 1583, in softmax
    ret = input.softmax(dim)
RuntimeError: CUDA out of memory. Tried to allocate 16.00 GiB (GPU 0; 39.59 GiB total capacity; 19.77 GiB already allocated; 3.04 GiB free; 34.65 GiB reserved in total by PyTorch)
Traceback (most recent call last):
  File "/appl/python/3.6.2/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/appl/python/3.6.2/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/zhome/f9/4/160189/env_a100/lib/python3.6/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/zhome/f9/4/160189/env_a100/bin/python', '-u', './tools/train.py', '--local_rank=1', '--config-file', 'configs/cityscapes_danet_resnet.yaml']' returned non-zero exit status 1.
